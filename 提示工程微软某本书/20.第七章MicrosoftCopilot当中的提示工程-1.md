### 第7章 Microsoft Copilot中的提示工程
#### 7.1 Microsoft 365 Copilot概览

Microsoft 365是微软推出的一套云服务，包括Office、OneDrive等多种应用，可以帮助用户在不同设备上高效地完成工作和学习。Microsoft 365 Copilot是一项新的功能，它是微软利用人工智能技术，为用户提供智能的交互和建议，从而提升用户在Microsoft 365中使用应用的体验和效率。

Microsoft 365 Copilot目前主要支持3个应用：Word、PowerPoint和Excel。它们分别对应于文档、演示和表格3种常见的办公文件格式。在这3个应用中，用户可以通过语音或键盘输入自然语言，描述自己想要完成的任务或达到的目标，然后Copilot会根据用户的输入，生成相应的提示（prompt）来引导用户进行下一步操作。

##### 7.1.1 Copilot中的提示
提示是Copilot与用户交互的核心元素。它可以是一个问题、一个命令、一个选项、一个建议、一个示例或者一个反馈。提示的目的是帮助用户更快更准确地表达自己的意图，解决自己遇到的问题，完成自己想要做的事情。Copilot提示有以下几个特点。
- **提示基于上下文生成**：Copilot会根据用户当前打开的文件类型、内容、格式等信息，以及用户之前输入过的语句或命令，生成最合适最相关的提示。
- **提示动态更新**：随着用户输入内容或选择选项，Copilot会实时更新提示内容和形式，以适应用户不断变化的需求和状态。
- **提示灵活多样**：Copilot会根据不同情境和任务类型，生成不同风格和层次的提示。
- **提示可视化呈现**：Copilot会根据不同文件格式和功能模块，在合适位置显示相应形式和样式的提示。有些提示以文本方式出现在文件中；有些提示以图标按钮方式出现在工具栏上；有些提示以弹窗列表方式出现在屏幕旁边。

通过使用Copilot，在Word中编写文档，在PowerPoint中制作演示，在Excel中处理表格都将变得更加简单轻松高效。无论你是想要写一份报告、做一次演讲还是分析一组数据，在这里都可以找到最适合你需求/想法/风格的提示和建议。

##### 7.1.2 Copilot系统
那么，Copilot是如何做到这些的呢？它主要由3个部分组成。
- **Microsoft 365 Apps**：这是用户与Copilot交互的界面，包括Word, Teams, PowerPoint, Excel, Outlook等常用应用。每个应用都有自己专属的功能和场景，但都可以通过一个统一的快捷键或按钮激活Copilot。
- **Microsoft Graph**：这是一个全面且安全地记录和连接用户在Microsoft 365平台上所有内容、行为、关系和上下文的图数据服务。例如，它可以存储和访问你写过或收到过的邮件、文件、会议、聊天和日历等信息，并且根据你对它们的操作来更新它们之间的联系。Microsoft Graph为Copilot提供了丰富且实时的数据源和知识库。 
- **大语言模型（LLM）**：这是一个基于人工神经网络和自然语言处理技术构建的强大且通用的语言模型。它可以根据输入（prompt）生成输出（response），并且能够在不同领域和任务之间迁移学习。大语言模型为Copilot提供了智能且灵活的语言生成能力。


下面详细介绍这3个部分是如何协同工作，并为用户提供高质量且高效率的提示服务（prompting service）。

首先，Copilot会对用户输入进行预处理，包括纠正拼写错误、消除歧义、标准化格式等操作，其目标是提升提示的质量，使其跟用户想要得到的答案更接近，或者更可执行。与此同时，Copilot会对提示进行关联（grounding），即寻找与提示相关联的内容和上下文，并加以利用。为了做到这一点，Copilot会向Microsoft Graph发送请求，并从中检索跟用户当前业务相关的信息，如之前写过或收到过的类似邮件、文件、会议记录等。这些信息可以帮助Copilot更好地理解用户的需求和背景，并提供更具针对性和个性化的建议。

其次，Copilot将经过预处理和关联后的提示发送给大语言模型，并请求它生成一个或多个响应。大语言模型会利用自己庞大而多样化的语料库，并根据不同App和场景调整自己的参数，来生成合适且有创意的输出。

最后，Copilot会对大语言模型生成的响应进行后处理，包括检查输出是否符合逻辑、语法、格式等标准，并根据需要进行修正或优化。同时，在后处理过程中也会再次向Microsoft Graph发送关联请求，并做一些合规性检查，例如是否有侵犯版权、泄露隐私等风险。

当输出达到满意程度后，Copilot就会将结果返回给App，并展示给用户。用户可以选择接受或修改结果，或者重新输入另一个提示。

通过以上几个步骤，Copilot就完成了一次提示服务。值得注意的是，这些步骤并不是固定不变而是动态调整地执行：根据不同App和场景，不同步骤所占比重也不同；根据不同提示和响应，不同步骤所需时间也不同；根据不同用户反馈，不断学习并改进。



本章接下来重点介绍Word Copilot、PowerPoint Copilot、Excel Copilot这3个功能强大丰富智能的子系统，并且展示它们如何运用各种各样精彩绝伦的提示与用户进行有效愉快的交互。

![image](https://github.com/user-attachments/assets/82a8c2e1-d091-49da-a8d7-58bcee7134bc)


#### 7.2 Word Copilot
Word是Microsoft 365中最常用的文档编写工具，无论是写作业、报告、合同还是小说，用户都可以利用Word的强大功能来完成。但是，有时候用户可能会遇到一些困难或者疑问，例如：
- 如何快速找到相关的资料或者引用？
- 如何根据写作目的和读者选择合适的语言和风格？
- 如何改进文档的结构和逻辑？
- 如何检查和纠正文档中的错误或者不一致？

这时候，就可以借助Word Copilot来解决这些问题。Word Copilot是一个智能助手，它可以根据文档内容和上下文，给出一些有用的提示（prompt）和建议（suggestion），让用户更高效、更专业地完成写作任务。

![image](https://github.com/user-attachments/assets/d798c436-8ccf-40e0-8563-56a897383fa3)

![image](https://github.com/user-attachments/assets/bf0ccefe-bb77-4a02-8a3e-50244e12dc55)


##### 7.2.1 Word Copilot基本功能
Word Copilot的基本功能可以分为以下几类。
- **语法检查与改进建议**：Word Copilot可以检测文档中的语法错误、拼写错误、用词不当等问题，并给出相应的修改建议，用户可以一键接受或忽略这些建议。Word Copilot还可以提供更高级的改进建议，例如，让句子更加简洁明了、避免重复或冗余、保持一致性等。
- **写作风格与语言调整**：Word Copilot可以根据写作目标和场景，帮助用户调整文档的风格和语言。例如，如果你要写一份正式的商业报告，Word Copilot可以提醒你避免使用口语化或过于随意的表达方式，使用更加专业和正规的词汇和格式；如果你要写一篇具有说服力的论述文，Word Copilot可以提示你如何构建有效的论点和证据，使用恰当的过渡词和连接词等。 
- **文档结构与内容优化**：Word Copilot不仅可以帮助改进文档中每个句子或段落的质量，还可以帮助优化整个文档的结构和内容。例如，如果你要写一篇研究论文，Word Copilot可以根据常见的研究论文格式，给出相应的标题、摘要、引言、方法、结果、讨论等部分，并提供相关部分应该包含哪些信息和如何撰写的建议；如果你要写一本小说或故事，Word Copilot可以根据常见的小说或故事结构（如开头、发展、转折、高潮、结局等），给出相应部分应该设置哪些情节和如何描述人物与环境等。 
- **智能搜索与引用**：Word Copilot可以在后台自动搜索与文档相关主题或信息，并在适当时机为用户呈现这些信息。例如，在编写历史报告时直接插入相关历史资料及引用；在编写科学文章时直接插人相关数据及图表；在编写新闻报道时直接插入相关事件及评论等。这样可以节省用户查找资料和引用来源的时间，并保证文档内容真实可靠。 

以上就是Word Copilot的基本功能介绍。通过这些功能，Word Copilot就像一个懂得各种领域知识且有着丰富经验的老师或同伴，在写作时陪伴着我们，并给予我们及时有效的指导与反馈。下面将详细介绍Word Copilot与用户进行提示交互的基本原理，以及它采用了哪些典型交互类型并给出具体的提示实例。

##### 7.2.2 Word Copilot提示交互的基本原理
Word Copilot系统架构由3个主要部分组成：意图识别，实体抽取和意图处理。下面分别介绍这3个部分的功能和作用，并重点说明它们之间是如何交互的。

![image](https://github.com/user-attachments/assets/84bd546c-b28e-4bfd-b60b-6da4a40ef54b)

- **意图识别**：是Word Copilot系统中负责理解用户意图的模块。它可以根据用户输入的提示（即用户发出的请求或指令），判断出用户想要做什么。例如，如果用户输入“写一篇关于人工智能的文章”，那么意图识别模块就会识别出这是一个内容生成的意图；如果用户输入“增加页眉页脚”，那么它就会识别出这是一个特殊命令的意图；如果用户输入“显示编辑历史”，那它就会识别出这是一个搜索的意图。
- **实体抽取**：是Word Copilot系统中负责识别实体信息的模块。实体信息指的是与用户意图相关联的具体对象或属性，如主题、关键词、标题、段落、格式等。实体抽取可以根据用户输入的提示，提取出其中包含的实体信息，并将其标注出来。例如，如果用户输入“写一篇关于人工智能的文章”，那它就会提取出“人工智能”这个主题实体，并标注为主题类型；如果用户输入“给我的报告加上总结”，它就会提取出“我的报告”这个文档实体，并标注为文档类型。 
- **意图处理**：是Word Copilot系统中负责处理不同类型意图并生成相应动作和结果的模块。它包含三个子模块：内容生成、命令和查询。
    - **内容生成模块**：负责处理内容生成类意图，它可以根据用户指定或推断出来的主题、关键词、标题等信息，调用通用或专业化GPT（或其他语言模型）来生成适合文档风格和结构的内容，并将其转化为文档编辑动作。例如，如果用户输入“写一篇关于人工智能的文章”，那么它会使用常规生成文章的提示去调用GPT，并将其转化为插入新段落、设置标题等文档编辑动作。如果用户输入“给我的报告加上总结”，那么它就会调用特殊的有关摘要的提示来生成一个针对报告主要观点和结论的总结，并将其转化为插入新段落、设置小标题等文档编辑动作。 
    - **命令模块**：负责处理命令类意图，它可以根据用户指定或推断出来的操作对象、属性或参数，执行相应的命令动作，并返回执行结果或反馈信息。例如，如果用户输入“保存我的文档到云端”，那么它就会执行保存文件到云端的命令动作，并返回保存成功或失败等反馈信息。如果用户输入“把字体大小改成14号”，那么它就会执行改变字体大小的命令动作，并返回改变成功或失败等反馈信息。 
    - **查询模块**：负责处理查询类意图，它可以根据用户指定或推断出来的查询对象、条件或范围，提供相应的查询结果或展示方式。例如，如果用户输入“显示编辑历史”，那么它就会提供当前文档所有修改记录及时间戳等查询结果，并以列表或时间轴等展示方式呈现给用户；如果用户输入“统计本章节有多少字数”，那么它就会提供当前章节所有文字及字符数等查询结果，并以数字或表格等展示方式呈现给用户；如果用户输入“给我推荐一些相关的参考文献”，那么它就会提供当前文档主题或关键词相关的参考文献等查询结果，并以链接或摘要等展示方式呈现给用户。 

##### 7.2.3 典型交互类型与提示实例
Word Copilot支持多种类型的提示交互，以下3类为特别常见的类型。
- **创建型**：这类提示旨在帮助用户创建一些新的内容或初稿，例如，写一个关于狗对人类健康好处的段落。
- **汇总型**：这类提示旨在帮助用户汇总或重写部分文档使其更加简洁或符合目标读者的需求，例如，用三句话概括这篇文章的主要观点。 
- **润色型**：这类提示旨在帮助用户对表达方式进行润色和修改，提高文档的可读性和逻辑性。


下面通过3个例子来展示这3类提示以及对应GPT生成的答案。

1. **实例一：根据书面文档或简单提示创建初稿**
    - **提示**：用中文写一篇200字左右关于“五一小长假”的博客文章。
    - **GPT回答**：五一小长假，是我一直期待的假期。今年，由于疫情防控和经济复苏的双重因素，五一小长假更显得珍贵和热闹。据统计，全国旅游接待人数达到2.3亿人次，同比增长119.7%，旅游收入超过1130亿元，同比增长138.1%。这些数据显示了人们对出行的强烈需求和信心。

我和家人也趁着这个机会，去了附近的一个风景区。那里有清澈的湖水，翠绿的山峦，还有各种鲜花和野生动物。我们乘船游湖，登山观景，拍照留念，感受大自然的魅力和生机。虽然景区人多车多，但是我们都遵守规则，佩戴口罩，保持距离，尽量减少接触。我们也注意了防晒和补水，保护好自己的健康。

五一小长假给我留下了美好的回忆和感悟。我觉得，在这个特殊的时期，能够安全、愉快地旅行，是一种幸运和奢侈。我也为祖国的发展和进步感到自豪和欣慰。我希望未来能有更多的机会去探索更多的地方，体验更多的文化，享受更多的美好。

2. **实例二：汇总或重写部分文档使其更加简洁**

    - **提示**：总结这篇博客的主要内容。
    - **GPT回答**：
        - 博主分享了五一小长假的旅行经历，去了一个风景优美的地方，感受了大自然的魅力。
        - 博主也表达了对出行需求和信心的理解，对防疫措施和健康保护的重视，对祖国发展和进步的自豪和欣慰。 

3. **实例三：对表达方式进行润色和修改**
    - **提示**：请修改这篇博客的表达方式，使其更加幽默风趣。
    - **GPT回答**：五一小长假，是我一直盼星星盼月亮的假期。今年，由于疫情防控和经济复苏的双重压力，五一小长假更像是一场千载难逢的狂欢。据说，全国旅游接待人数达到2.3亿人次，同比增长119.7%，旅游收入超过1130亿元，同比增长138.1%。这些数据让我感觉自己是在参加了一个超级彩票抽奖。
我和家人也抓住了这个机会，去了附近的一个风景区。那里有清澈的湖水，翠绿的山峦，还有各种鲜花和野生动物。我们乘船游湖，登山观景，拍照留念，感觉自己像是进入了一个童话世界。虽然景区人山人海，但是我们都守法守规，戴着口罩，保持距离，尽量不搭理陌生人。我们也注意了防晒和补水，保护好自己的皮肤和身体。 
